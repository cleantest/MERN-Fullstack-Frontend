<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>After School Classes - Book Your Activities</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div id="app">
    <header class="header">
      <h1>After School Activities</h1>
      <div class="header-actions">
        
        <button 
  class="cart-btn" 
  :class="{ disabled: cartItems.length === 0 }"
  @click="cartItems.length > 0 && toggleCart()"
>
  Cart ({{ cartItems.length }})
</button>

      </div>
    </header>

    <!-- Cart View -->
    <main v-if="showCart" class="main-content">
      <div class="cart-header">
        <h2>Your Cart</h2>
        <button @click="toggleCart" class="back-btn">← Back to Classes</button>
      </div>

      <div v-if="cartItems.length === 0" class="empty-cart">
        <h3>Your cart is empty</h3>
        <p>Add some classes to get started!</p>
        <button @click="toggleCart" class="continue-btn">Browse Classes</button>
      </div>

      <div v-else class="cart-content">
        <div class="cart-items">
          <div v-for="item in cartItems" :key="item.id" class="cart-item-card">
            <img :src="appURL + '/' + item.icon" :alt="item.subject" class="cart-icon" />
            <div class="cart-item-details">
              <h3>{{ item.subject }}</h3>
              <p class="location">{{ item.location }}</p>
              <p class="price">£{{ item.price }}</p>
            </div>
            <button @click="removeFromCart(item)" class="remove-btn">Remove</button>
          </div>
        </div>

        <div class="cart-summary">
          <div class="cart-total">
            <h3>Total: £{{ cartTotal }}</h3>
          </div>
          <button @click="showCheckout = true" class="checkout-btn">
            Proceed to Checkout
          </button>
        </div>
      </div>
    </main>

    <!-- Checkout Form -->
    <div v-if="showCheckout" class="checkout-overlay">
      <div class="checkout-modal">
        <div class="checkout-header">
          <h2>Checkout</h2>
          <button @click="showCheckout = false" class="close-btn">×</button>
        </div>

        <form @submit.prevent="processCheckout">
          <div class="form-group">
            <label for="parentName">Student Name:</label>
            <input
              type="text"
              id="parentName"
              v-model="checkoutForm.parentName"
              :class="{ 'error': !isValidName }"
              placeholder="Enter full name"
              required
            />
            <span v-if="!isValidName && checkoutForm.parentName" class="error-msg">
              Name should contain letters only
            </span>
          </div>

          <div class="form-group">
            <label for="phone">Phone Number:</label>
            <input
              type="tel"
              id="phone"
              v-model="checkoutForm.phone"
              :class="{ 'error': !isValidPhone }"
              placeholder="Enter phone number"
              required
            />
            <span v-if="!isValidPhone && checkoutForm.phone" class="error-msg">
              Phone should contain numbers only
            </span>
          </div>

          <div class="checkout-summary">
            <h3>Order Summary:</h3>
            <div v-for="item in cartItems" :key="item.id" class="summary-item">
              {{ item.subject }} - £{{ item.price }}
            </div>
            <div class="summary-total">
              <strong>Total: £{{ cartTotal }}</strong>
            </div>
          </div>

          <button type="submit" :disabled="!canCheckout" class="submit-btn">
            Complete Booking
          </button>
        </form>
      </div>
    </div>

    <!-- Success Message -->
    <div v-if="showSuccess" class="success-overlay">
      <div class="success-modal">
        <h2>Booking Confirmed!</h2>
        <p>Thank you {{ checkoutForm.parentName }}! Your classes have been booked.</p>
        <p>We'll contact you at {{ checkoutForm.phone }} with further details.</p>
        <button @click="resetApp" class="ok-btn">OK</button>
      </div>
    </div>

    <!-- Main Content -->
    <main v-if="!showCart" class="main-content">
      <div class="intro">
        <h2>Choose from our exciting after school activities</h2>
        <p>Help your child discover new talents and make friends!</p>
<!-- Sort Controls -->

        <div class="sort-controls">
          <label for="sortSelect">Sort by:</label>
          <select id="sortSelect" v-model="sortOption" class="sort-select">
            <option value="">Relevance</option>
            <option value="price-asc">Price: Low to High</option>
            <option value="price-desc">Price: High to Low</option>
            <option value="location-asc">Location: A → Z</option>
            <option val1ue="location-desc">Location: Z → A</option>
            <option value="subject-asc">Lesson: A - Z</option>
            <option value="subject-desc">Lesson: Z - A</option>


          </select>
        </div>
    
<!-- Search Bar -->

        <input
          type="text"
          v-model="searchQuery"
          placeholder="Search for activities..."
          class="search-bar"
        />
      </div>

      <div class="lessons-grid">
        <div
          v-for="lesson in finalLessonsToDisplay"
          :key="lesson.id"
          class="lesson-card"
          :class="{ 'sold-out': lesson.spaces === 0 }"
        >
          <!--<img :src="lesson.icon" :alt="lesson.subject" class="lesson-icon" /> -->
          <img :src="appURL + '/' + lesson.icon" />

          <div class="lesson-info">
            <h3>{{ lesson.subject }}</h3>
            <p class="location">{{ lesson.location }}</p>
            <p class="price">£{{ lesson.price }}</p>
            <p class="spaces" :class="{ 'low-spaces': lesson.spaces <= 3 }">
              {{ lesson.spaces > 0 ? lesson.spaces + ' spaces left' : 'Sold Out' }}
            </p>
          </div>
          <button
            @click="addToCart(lesson)"
            :disabled="lesson.spaces === 0 || isInCart(lesson)"
            class="add-btn"
          >
            {{ isInCart(lesson)
              ? 'Added ✓'
              : lesson.spaces === 0
              ? 'Sold Out'
              : 'Add to Cart' }}
          </button>
        </div>
      </div>
    </main>
  </div>

  <script src="app.js"></script>
  <footer class="site-footer">
  <p>© 2025 After School Activities — All Rights Reserved.</p>
</footer>
</body>
</html>
